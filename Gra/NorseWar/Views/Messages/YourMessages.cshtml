@{
    ViewBag.Title = "YourMessages";
    Layout = "~/Views/Shared/_Layout.cshtml";

 }

<table class="listMsg" style="width:50%; float:left;">
    <thead>
        <tr>
            <th>
                Nadawca
            </th>
            <th>
                Temat
            </th>
            <th>
                Data
            </th>
        </tr>
    </thead>
    <tbody>
        @foreach (NorseWar.Models.Message item in Model)
        {
            if (item.Status == false)
            {
                <tr onclick="showMessage(@item.MessageId)" id="@item.MessageId" style="background-color: #767b4f; font-weight:bold;">
                    <td>@NorseWar.Helper.Methods.ShowLoginFromId(item.SenderId)</td>
                    <td>@item.Title</td>
                    <td>@NorseWar.Helper.Methods.ChangeData(item.Date)</td>
                </tr>
            }
            else
            {
                <tr onclick="showMessage(@item.MessageId)" id="@item.MessageId">
                    <td>@NorseWar.Helper.Methods.ShowLoginFromId(item.SenderId)</td>
                    <td>@item.Title</td>
                    <td>@NorseWar.Helper.Methods.ChangeData(item.Date)
                    <td>
                </tr>
            }

        }
    </tbody>
</table>

<script>
    function showMessage(id) {
        $(".tableMsg").css("visibility", "visible");
        $(".deletemsg").attr("onclick", "DeleteMessage("+id+")");
        $(".deletemsg").css("visibility", "visible");
        $('#'+id).removeAttr("style");
        $("#messageText").css({ "visibility": "visible" });
        $.ajax({
            type: 'POST',
            url: '@Url.Action("GetMessage", "Messages")',
            data: "id=" + id,
            success: function (data) {
                //alert(data);
                $("#title").html("Temat: "+data.Title);
                $("#text").html("&emsp;"+data.Text);
                showSenderLogin(data.SenderId);


            }
        });

        $.ajax({
            type: 'POST',
            url: '@Url.Action("ChangeMessageStatus", "Messages")',
            data: "id="+id,
            success: function(data){
                //alert(data);
            }
        });


    }

    function DeleteMessage(id) {
        $(".tableMsg").css("visibility", "visible");
        $.ajax({
            type: 'POST',
            url: '@Url.Action("DeleteMessage", "Messages")',
            data: "id=" + id,
            success: function () {
                $(".tableMsg").css("visibility", "hidden");
                $("#" + id).remove();
                $(".deletemsg").css("visibility", "hidden");

            }
        });
    }

    function showSenderLogin(id){
        $.ajax({
            type: 'POST',
            url: '@Url.Action("SenderLogin", "Messages")',
            data: "id=" + id,
            success: function (data) {
                $("#sender").html("Od: " + data);
            }
        });


    }

</script>

<table class="tableMsg" id="messageText">
    <thead>
        <tr>
            <th id="title"></th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td id="sender"></td>
        </tr>
        <tr>
            <td id="text"></td>
        </tr>
        <tr>

            <td>
                <input type="button" onclick="DeleteMessage()" value="Spal wiadomość" class="button deletemsg" style="visibility: hidden">
            </td>

        </tr>
    </tbody>
</table>

<style>
    tr:hover {
        background-color: transparent;
    }

    .button {
  padding: 0 1rem;
  height: 2.125rem;
  text-align: center;
  vertical-align: middle;
  background-color: #ffffff;
  border: 2px #d9d9d9 solid;
  color: #262626;
  cursor: pointer;
  display: inline-block;
  outline: none;
  font-size: .875rem;
  line-height: 100%;
  margin: .15625rem 0;
  position: relative;
  font-family: edmundis, josschrift;
}

.button.deletemsg {
  background: #191E08;
  color: #828E20;
  border-color: #828E20;
}
.button.deletemsg:active {
  background: #128023;
  color: #ffffff;
}
</style>